<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>EV 路线与充电站规划</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <style>
      body { background: linear-gradient(180deg,#f7fbff 0%, #eef6ff 100%); min-height:100vh; }
      .card { border-radius:12px; box-shadow:0 6px 18px rgba(20,40,80,0.08); }
      .brand-note { font-size:0.9rem; color:#555; }
      footer { font-size:0.85rem; color:#777; margin-top:18px; }
    </style>
  </head>
  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
          <div class="card p-4">
            <h3 class="mb-3">电动车路线与充电站智能规划</h3>
            <p class="brand-note mb-3">从数据库读取车辆参数。输入品牌可优先匹配数据库记录；若未命中则使用默认车辆配置。</p>

            <form action="/plan" method="post" id="planForm" class="row g-3">
              <div class="col-md-6">
                <label class="form-label">汽车品牌或名称</label>
                <input type="text" class="form-control" name="brand" placeholder="例如：Tesla 或 EV-Demo" />
              </div>

              <div class="col-md-6">
                <label class="form-label">当前电量 (%)</label>
                <div class="d-flex gap-2 align-items-center">
                  <input id="socRange" type="range" class="form-range flex-grow-1" min="0" max="100" value="70" name="start_soc"/>
                  <input id="socNumber" type="number" class="form-control" style="width:80px;" min="0" max="100" value="70" />
                </div>
                <div class="form-text">通过滑块或数字输入设置当前电量百分比。</div>
              </div>

              <div class="col-12">
                <label class="form-label">起点地址</label>
                <input type="text" class="form-control" name="origin" placeholder="例如：天津城建大学" value="天津城建大学" required />
              </div>

              <div class="col-12">
                <label class="form-label">终点地址</label>
                <input type="text" class="form-control" name="destination" placeholder="例如：天津滨海国际机场" value="天津滨海国际机场" required />
              </div>

              <div class="col-12 d-flex justify-content-between align-items-center">
                <div>
                  <button type="submit" class="btn btn-primary">开始规划</button>
                  <button type="button" id="swapBtn" class="btn btn-outline-secondary ms-2">交换起终点</button>
                </div>
                <small class="text-muted">支持百度地图或本地 mock 数据（取决于配置）</small>
              </div>
            </form>

            <footer class="mt-3">
              <div>提示：若想快速测试，可直接点击开始规划，系统会在缺少坐标时使用示例位置。</div>
            </footer>
          </div>
        </div>
      </div>
    </div>

    <script>
      // 同步滑块与数字输入
      const socRange = document.getElementById('socRange');
      const socNumber = document.getElementById('socNumber');
      socRange.addEventListener('input', () => socNumber.value = socRange.value);
      socNumber.addEventListener('input', () => {
        let v = Number(socNumber.value);
        if (isNaN(v)) v = 0;
        if (v < 0) v = 0;
        if (v > 100) v = 100;
        socNumber.value = v;
        socRange.value = v;
      });

      // 将数字值同步到隐藏表单域 name="start_soc"
      // （滑块已设置 name=start_soc，确保提交时带上正确值）
      socNumber.addEventListener('change', () => socRange.value = socNumber.value);

      // 交换起终点
      document.getElementById('swapBtn').addEventListener('click', () => {
        const form = document.getElementById('planForm');
        const origin = form.elements['origin'];
        const destination = form.elements['destination'];
        const tmp = origin.value;
        origin.value = destination.value;
        destination.value = tmp;
      });
    </script>

    <!-- Bootstrap JS bundle (optional) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>